# Стратегия тестирования проекта MoonBit

> Этот документ основан на оригинальном TESTING.md из проекта и интегрирован с архитектурными принципами и паттернами, описанными в Memory Bank.

## Связь с Memory Bank
- Архитектурные принципы: см. [architecturalPrinciples.md](./architecturalPrinciples.md)
- Архитектура системы: см. [systemPatterns.md](./systemPatterns.md)
- Технический стек: см. [techContext.md](./techContext.md)
- Актуальный прогресс: см. [progress.md](./progress.md)

---

# Система тестирования проекта MoonBit

В проекте MoonBit используется комплексный подход к тестированию, обеспечивающий высокое качество кода и стабильность работы приложения. 

## Структура тестов

### Серверная часть (Node.js/Express)

- **Фреймворк**: Jest
- **Тестирование API**: Supertest

Структура директорий:
```
server/
  __tests__/
    services/      # Тесты для сервисов
    routes/        # Тесты для API-маршрутов
    utils/         # Тесты для утилит
```

### Клиентская часть (React)

- **Фреймворк**: Jest
- **Тестирование компонентов**: React Testing Library

Структура директорий:
```
client/
  __tests__/
    components/    # Тесты для React-компонентов
  __mocks__/       # Моки для стилей и ресурсов
```

## Запуск тестов

### Серверная часть

```bash
cd bitcoin-moon/server
npm test                # Запуск всех тестов
npm run test:watch      # Запуск тестов в режиме наблюдения
npm run test:coverage   # Запуск тестов с отчетом о покрытии
```

### Клиентская часть

```bash
cd bitcoin-moon/client
npm test                # Запуск всех тестов
npm run test:watch      # Запуск тестов в режиме наблюдения
npm run test:coverage   # Запуск тестов с отчетом о покрытии
```

## Типы тестов

### Юнит-тесты

- Тестирование отдельных функций и методов
- Мокирование зависимостей
- Проверка всех возможных путей выполнения

### Интеграционные тесты

- Тестирование взаимодействия между компонентами системы
- Тестирование API-эндпоинтов
- Проверка корректности передачи данных между слоями приложения

### Компонентные тесты (для React)

- Тестирование отображения компонентов
- Тестирование обработки пользовательских событий
- Тестирование жизненного цикла компонентов

## Правила написания тестов

1. **Изоляция тестов**: Каждый тест должен быть независимым от других тестов
2. **Описательные имена**: Имена тестов должны ясно описывать, что именно тестируется
3. **Мокирование зависимостей**: Внешние зависимости (API, файловая система и т.д.) должны быть замокированы
4. **Полное покрытие**: Стремитесь к 100% покрытию кода тестами
5. **Состояния**: Тестируйте все возможные состояния (загрузка, успех, ошибка и т.д.)

## Соглашения по именованию

- Файлы с тестами должны иметь суффикс `.test.js`
- Названия тестов должны следовать формату `describe('Компонент/Модуль', () => { it('должен делать что-то', () => {...}) })`

## Интеграция с CI/CD

В будущем планируется интеграция тестов с системой непрерывной интеграции для автоматического запуска тестов при создании pull-запросов и деплое.

## Примеры тестов

### Тест серверного сервиса
```javascript
// __tests__/services/BitcoinService.test.js
describe('BitcoinService', () => {
  it('should return cached price if cache is valid', async () => {
    // ...
  });
});
```

### Тест API-эндпоинта
```javascript
// __tests__/routes/bitcoin.test.js
describe('GET /api/bitcoin/price', () => {
  it('should return current bitcoin price', async () => {
    // ...
  });
});
```

### Тест React-компонента
```javascript
// __tests__/components/CurrentPrice.test.js
describe('CurrentPrice Component', () => {
  it('should render price data correctly', async () => {
    // ...
  });
});
``` 